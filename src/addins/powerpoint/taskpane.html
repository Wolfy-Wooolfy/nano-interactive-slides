<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Nano Interactive Slides</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family:system-ui,Segoe UI,Arial,sans-serif;margin:16px}
    .row{display:flex;align-items:center;gap:10px;margin-bottom:12px}
    .row label{width:110px}
    .row input[type="range"]{flex:1}
    .grid{display:grid;gap:12px}
    .btns{display:flex;gap:8px;flex-wrap:wrap}
    .value{min-width:48px;text-align:right}
    .card{border:1px solid #ddd;border-radius:10px;padding:12px}
    canvas{width:100%;height:auto;border:1px dashed #ccc;border-radius:8px}
    .muted{font-size:12px;color:#777}
    .tog{display:flex;align-items:center;gap:8px}
    .half{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  </style>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script defer src="./taskpane.js"></script>
</head>
<body>
  <h2>Nano Interactive Slides</h2>
  <div class="grid">
    <div class="card">
      <div class="row">
        <label for="speed">Speed</label>
        <input id="speed" type="range" min="1" max="100" step="1" value="50" />
        <div class="value" id="speedVal">50</div>
      </div>
      <div class="row">
        <label for="capacity">Capacity</label>
        <input id="capacity" type="range" min="1" max="500" step="1" value="100" />
        <div class="value" id="capacityVal">100</div>
      </div>
      <div class="row">
        <label for="delay">Delay</label>
        <input id="delay" type="range" min="0" max="10" step="0.1" value="1" />
        <div class="value" id="delayVal">1.0</div>
      </div>
      <div class="half">
        <div class="tog"><input id="projectToggle" type="checkbox" checked /><label for="projectToggle">Project to slide</label></div>
        <div class="row"><label for="projectMs">Project ms</label><input id="projectMs" type="number" min="250" step="50" value="1000" /></div>
      </div>
      <div class="btns">
        <button id="start">Start</button>
        <button id="stop">Stop</button>
        <button id="reset">Reset</button>
        <button id="snapshot">Snapshot Now</button>
        <button id="exportJson">Export JSON</button>
        <button id="importJson">Import JSON</button>
        <input id="jsonFile" type="file" accept="application/json" style="display:none" />
        <button id="downloadPng">Download PNG</button>
      </div>
      <div class="muted" id="hostHint"></div>
    </div>

    <div class="card">
      <div class="row"><label>Live Preview</label><div class="muted">auto-render</div></div>
      <canvas id="preview" width="560" height="280"></canvas>
    </div>
  </div>
</body>
</html>
